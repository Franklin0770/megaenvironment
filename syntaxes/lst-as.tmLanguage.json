{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "AS - Listing Files",
	"scopeName": "source.lst-as",
	"foldingStartMarker": "^\\s*(?i:macro|if|ifn?(?:def|symexist|used|exist|b)|rept|irpc?|while|function|struct|switch)\\b",
	"foldingStopMarker": "^\\s*(?i:end(?:if|struct|case|m))\\b",
	"patterns": [
		{ "include": "#lst-constants" },
		{ "include": "#instruction-label-structure" },
		{ "include": "#instructions" },
		{ "include": "#sizes" },
		{ "include": "#autoincrements" },
		{ "include": "#variables" },
		{ "include": "#constants" },
		{ "include": "#comments" },
		{ "include": "#strings" },
		{ "include": "#labels" },
		{ "include": "#symbols" },
		{ "include": "#operators" },
		{ "include": "#functions" },
		{ "include": "#pseudo-instructions" }
	],
	"repository": {
		"lst-constants": {
			"patterns": [
				{
					"match": "^(\\(\\d\\))?\\s+(\\d+\/)?\\s*([0-9a-fA-F]{1,8}) : ((?:=-?\\$[0-9a-fA-F]{1,8})|(?:[0-9a-fA-F]{1,4} ?)*)",
					"captures": {
						"1": { "name": "line.pass.as" },
						"2": { "name": "line.codeLine.as" },
						"3": { "name": "line.address.as" },
						"4": { "name": "line.value.as" }
					}
				},
				{
					"name": "constant.header.as",
					"match": "^\\x0C? AS.+$"
				},
				{
					"name": "constant.message",
					"match": "^[^\\s*].+$"
				}
			]
		},
		"instructions": {
			"patterns": [
				{
					"name": "instruction.mnemonic.as",
					"match": "\\b(?i:move[qapm]?|[lp]ea|add[aiqx]?|sub[aiqx]?|cmp[aim]?|clr|tst|b(?:tst|chg|set|clr)|andi?|e?ori?|not|ls[lr]|as[lr]|rox?[lr]|negx?|ex[gt]|swap|[asn]bcd|mul[su]|div[su]|nop|tas|s(?:eq|ne|pl|mi|cc|cs|vs|vc|hi|ls|ge|lt|gt|le)|stop|chk|illegal|link|unlk|reset|trapv?|ld[id]?|ld[id]r|inc|dec|ad[dc]|sub|sbc|and|x?or|cpl?|exx?|push|pop|cp[id]r?|nop|bit|s[lr]a|srl|r[rl]d|r[lr]c?a?|set|res|[ed]i|im|halt|daa|neg|[cs]cf|ini?r?|indr?|out[ir]?|ot[id]r)\\b"
				},
				{
					"name": "instruction.jump.as",
					"match": "\\b(?i:b(?:ra|sr|c[cs]|eq|ne|pl|mi|v[sc]|h[is]|l[os]|g[et]|l[te])|j(?:mp|sr)|rt[ser]|j[pr]|call|djnz|ret[in]|rst)\\b"
				}
			]
		},
		"sizes": {
			"name": "instruction.size.as",
			"match": "(?i:\\.[bwls])(?!\\w)"
		},
		"autoincrements": {
			"name": "instruction.autoincrement.as",
			"match": "(?i:(?<=\\(a[0-7]\\))\\+|\\-(?=\\(a[0-7]\\)))"
		},
		"variables": {
			"name": "variable.register.as",
			"match": "\\b(?i:[da][0-7]|u?sp|ccr|pc|sr|af'?|bc|de|hl|i[xy]|sp|a|b|c|d|e|h|l|r|i)(?![\\w'])"
		},
		"constants": {
			"patterns": [
				{
					"name": "constant.immediate.as",
					"match": "(?<=\\s+)#(?=[\\w|$%@\\-('\"])"
				},
				{
					"name": "constant.numeric.as",
					"match": "(?<![\\w\\)])-?(?:\\d{1,10}|\\$[0-9a-fA-F]{1,8}|%[01]{1,32}|@[0-7]{1,11}|\\d{1,5}|[0-9a-fA-F]{1,4}h|[01]{1,16}b|[0-7]{1,6}[oq])(?!\\w)"
				}
			]
		},
		"comments": {
			"name": "directive.comment.as",
			"match": "\\;.*$"
		},
		"strings": {
			"patterns": [
				{
					"name": "directive.string.as",
					"begin": "\"",
					"end": "\""
				},
				{
					"name": "directive.string.as",
					"begin": "(?<!\\w)'",
  					"end": "'(?!\\w)"
				}
			]
		},
		"labels": {
			"patterns": [
				{
					"name": "directive.label.global.as",
					"match": "(?<!\\S)\\s\\w+:"
				},
				{
					"name": "directive.label.local.as",
					"match": "(?:\\s\\.[\\w\\.]+:)"
				},
				{
					"name": "directive.label.temporary.as",
					"match": "(?:\\s\\$\\$[\\w\\.]+:)"
				}
			]
		},
		"operators": {
			"name": "directive.operator.as",
			"match": "(?:\\w[\\s\\(]?)?\\K(?::=|==|!=|<=|>=|<>|<<|>>|\\|\\||&&|!!|><|[-+*\\/#^~|&=<>!])"
		},
		"functions": {
			"name": "directive.function.as",
			"match": "\\b(?i:sqrt|a?sinh?|a?cosh?|a?tanh?|a?coth?|exp|a?log|a?ld|ln|int|bit(?:cnt|pos)|(?:first|last)bit|sgn|abs|to(?:upper|lower)|(?:up|low)string|strlen|substr|charfromstr|strstr|val|exprtype|fsize)\\b"
		},
		"symbols": {
			"name": "directive.symbol.as",
			"match": "(?<!\\w)(?:TRUE|FALSE|CONSTPI|FLOATMAX|VERSION|ARCHITECTURE|DATE|TIME|MOM(?:CPU(?:NAME)?|FILE|LINE|PASS|SECTION)|[\\.\\$])(?![\\w\\$])"	
		},
		"pseudo-instructions": {
			"name": "directive.pseudo.as",
			"match": "\\b(?i:d[csbw]|set|equ|b?include|r?org|cpu|(?:de)?phase|rept|macro|function|endm?|(?:end)?struct|(?:end)?if|ifn?(?:def|symexist|used|exist|b)|else(?:if)?|switch|(?:else|end)?case|while|page(?:size)?|listing|padding|save|restore|align|message|warning|error|fatal|(?:end)?section|label|charset|codepage|pushv|popv|(?:sup|comp)mode|intsyntax|relaxed|segment|assume|(?:end)?expect|irpc?|exitm|shift|maxnest|newpage|macexp_(?:dft|ovr)|title|(?:out)?radix|public|global|forward|shared|read)\\b"
		},
		"instruction-label-structure": {
			"patterns": [
				{
					"match": "(?i:\\b(b(?:ra|sr|c[cs]|eq|ne|pl|mi|v[sc]|h[is]|l[os]|g[et]|l[te])|j(?:mp|sr))(\\.[swl])?)\\b\\s+((?:\\.|\\$\\$)?(?:[\\w\\.]+|[+-]))",
					"captures": {
						"1": { "name": "instruction.jump.as" },
						"2": { "name": "instruction.size.as" },
						"3": { "name": "directive.label.jump.as" }
					}
				},
				{
					"match": "(?i:\\b(db(?:t|f|c[cs]|eq|ne|pl|mi|v[sc]|h[is]|l[os]|g[et]|l[te])))\\b\\s+(?i:\\b(d[0-7])\\b)\\s*,\\s*((?:\\.|\\$\\$)?(?:[\\w\\.]+|[+-]))",
					"captures": {
						"1": { "name": "instruction.jump.as" },
						"2": { "name": "variable.register.as" },
						"3": { "name": "directive.label.jump.as" }
					}
				},
				{
					"match": "\\b(?i:(j[pr]|call))\\b\\s+((?i:\\b(?:z|nz|c|nc|p|pe|po|m)\\b))\\s*,\\s*((?:\\.|\\$\\$)?(?:[\\w\\.]+))",
					"captures": {
						"1": { "name": "instruction.jump.as" },
						"2": { "name": "variable.flag.as" },
						"3": { "name": "directive.label.jump.as" }
					}
				},
				{
					"match": "\\b(?i:(j[pr]|call|djnz))\\b\\s+((?:\\.|\\$\\$)?[\\w\\.]+)\\b(?!\\s*,)",
					"captures": {
						"1": { "name": "instruction.jump.as" },
						"2": { "name": "directive.label.jump.as" }
					}
				},
				{
					"match": "\\b(?i:(ret))\\b\\s+((?i:\\b(?:z|nz|c|nc|p|pe|po|m)\\b))?",
					"captures": {
						"1": { "name": "instruction.jump.as" },
						"2": { "name": "variable.flag.as" }
					}
				}
			]
		}
	}
}